%\nonstopmode
\errorstopmode
% THIS IS NOT THE FILE YOU SHOULD PROCESS. IT IS THE "MAIN" FILE,
% BUT IT GETS INCLUDED BY ONE OF THE hott-xxx.tex FILES. THOSE ARE
% THE MAIN ONES.

% DOCUMENT CLASS
\documentclass[epub={split at=subsection},text,itex,class=book]{internet}

\usepackage{xspace}
\usepackage{hyperref}
\usepackage{aliascnt}
\def\appendix{}
\usepackage[capitalize]{cleveref}
\usepackage{braket}

\input{macros}

\usepackage{makeidx}
\makeindex

\title{Homotopy Type Theory: Univalent Foundations of Mathematics}
\author{The Univalent Foundations Program}

\epubMathInToc
\epubEmbedFont{
  family = STIXGeneral,
  regular = STIXGeneral.otf,
  italic = STIXGeneralItalic.otf,
  bold = STIXGeneralBol.otf,
  bolditalic = STIXGeneralBolIta.otf,
  format = opentype
}

\epubEmbedFont{
  family = STIXIntegral,
  regular = STIXIntDReg.otf,
  bold = STIXIntDBol.otf,
  format = opentype
}

\addcss+
body {
  max-width: 800px;
  font-family: Palatino, serif;
  font-size: 90%;
  line-height: 2;
}
math {
  font-family: STIXGeneral, STIXIntegral, serif;
  font-weight: normal;
  font-style: normal;
}
.index ul {
  line-height: 1.2;
}
.index ul p {
  margin: 0;
}
.footnote_tgt {
  vertical-align: super;
  margin-right: 1em;
  font-size: 80%;
}
.footnote_src {
  vertical-align: super;
  margin-right: 1em;
  font-size: 80%;
}
.footnote_tgt:before {
  content: "\021a9";
}
span.eqnnumber {
  float: right;
}
span.eqnnumber:before {
  content: "(";
}
span.eqnnumber:after {
  content: ")";
}
table.align {
  width: 100%;
}
table.align > tr {
  vertical-align: top;
}
table.align td.label {
  width: 2em;
}
.symbols table {
  width: 90%;
  line-height: 1.2;
  vertical-align: top;
}
.symbols table tr td:first-child {
  width: 20%;
}
.gentheorem {
  margin-left: 5%;
  margin-right: 5%;
  padding: .5em 1em;
  border-width: 2px;
  border-style: solid;
  border-color: #888;
  border-radius: 7px;
}
.proof {
  margin-left: 3%;
  margin-right: 3%;
  padding: .5em 1em;
  border-width: 2px;
  border-style: solid;
  border-color: #888;
  border-radius: 7px;
}
.proof .title {
  font-weight: bold;
    font-style: normal;
}
li.listlabel {
  list-style: none;
}
span.listlabel {
  float: left;
  margin-left: -10em;
  margin-right: 1em;
  width: 9em;
  text-align: right;
}
ol.bibliography {
  margin-left: 4em;
}
math[display="inline"] {
  white-space: nowrap;
}
[mathvariant="sans-serif"] {
  font-family: sans-serif;
}
mtd[columnalign="right"] {
  text-align: right;
}
mtd[columnalign="left"] {
  text-align: left;
}
h1 {
  page-break-before: always;
}
+

\addjavascript@
function moveEqNums() {
  var aligns = document.getElementsByClassName('align');
  for (var i = 0; i < aligns.length; i++) {
    var align = aligns[i];
    if (align.tagName == 'table')
    {
      var math = align.firstChild.childNodes[1].firstChild.childNodes[1].firstChild.firstChild.children;
var label = align.firstChild.childNodes[2].firstChild.children;
      for (var j = 0; j < math.length; j++) {
        label[j].style.height = math[j].scrollHeight + 'px';
      }
    }
  }
}

window.onload = moveEqNums;
@

\loadcss{mathml}

%\includeonly{reals}

\begin{document}
\itexSetCatcodes
% NB: This does not actually appear anywhere because we have
% a custom title page.

%\include{front} %%% Title page and copyright

%\include{preface}

%\mainmatter % Turn on roman page numbers and numbered chapters

\include{introduction}

\part{Foundations}
\label{part:foundations}


\include{preliminaries}

\include{basics}

\include{logic}

\include{equivalences}

\include{induction}

\include{hits}

\include{hlevels}

%\cleartooddpage[\thispagestyle{empty}] % Needed for correct TOC
\part{Mathematics}
\label{part:mathematics}

\include{homotopy}

\include{categories}

\include{setmath}

\include{reals}

%%%% Appendix

%\cleartooddpage[\thispagestyle{empty}] % Needed for correct TOC
\phantomsection % Needed for correct TOC also
\part*{Appendix}

% We use magic to get the appendix look like Bibliography and Index

\appendix

%\renewcommand{\chaptermark}[1]{\markboth{\textsc{Appendix. \thechapter. #1}}{}}
%\renewcommand{\sectionmark}[1]{\markright{\textsc{\thesection\ #1}}}

\include{formal}

% Joke
\nocite{Angiuli13}
\nocite{BauerAcceptanceVideo}

%%%% Bibliography
\bibliographystyle{halpha}
\phantomsection % black magic to get TOC to point to correct page
\addcontentsline{toc}{part}{\bibname}
\markboth{}{\textsc{Bibliography}}
{\renewcommand{\markboth}[2]{} % Prevent bibliography from resetting the header to something silly
%\OPTbibliographyfont
\bibliography{references}}

%\cleartooddpage[\thispagestyle{empty}]

%%%% Index of symbols

\include{symbols}

%\cleartooddpage[\thispagestyle{empty}]

%%%%% Index of terms

%% Global cross-references for index
\indexsee{principle}{axiom}
\indexsee{number!real}{real numbers}
\indexsee{abelian group}{group, abelian}
\indexsee{sequence!Cauchy}{Cauchy sequence}
\indexsee{adjunction}{adjoint functor}
\indexsee{higher topos}{$(\infty,1)$-topos}
\indexsee{topos!higher}{$(\infty,1)$-topos}
\indexsee{source!of a function}{domain}
\indexsee{target!of a function}{codomain}
\indexsee{type!truncation of}{truncation}
\indexsee{propositional!truncation}{truncation}
\indexsee{proof-relevant mathematics}{mathematics, proof-relevant}
\indexsee{classical!mathematics}{mathematics, classical}
\indexsee{classical!logic}{logic}
\indexsee{constructive!mathematics}{mathematics, constructive}
\indexsee{constructive!logic}{logic}
\indexsee{intuitionistic logic}{logic}
\indexsee{definition!inductive}{type, inductive}
\indexsee{inductive!definition}{type, inductive}
\indexsee{bounded!totally}{totally bounded}
\indexsee{sum!of numbers}{addition}
\indexsee{continuous map}{function, continuous}
\indexsee{function!continuity of@``continuity'' of}{``continuity''}
\indexsee{function!functoriality of@``functoriality'' of}{``functoriality''}
\indexsee{codes}{encode-decode method}
\indexsee{inequality}{order}
\indexsee{Coq@\Coq}{proof assistant}
\indexsee{Agda@\Agda}{proof assistant}
\indexsee{NuPRL@\NuPRL}{proof assistant}
\indexsee{generator!of an inductive type}{constructor}
\indexsee{groupoid!.infinity-@$\infty$-}{$\infty$-groupoid}
\indexsee{higher groupoid}{$\infty$-groupoid}
\indexsee{hierarchy!of n-types@of $n$-types}{$n$-type}
\indexsee{homotopy!n-type@$n$-type}{$n$-type}
\indexsee{homotopy!theory, classical}{classical homotopy theory}
\indexsee{homotopy!fiber}{fiber}
\indexsee{homotopy!limit}{limit of types}
\indexsee{homotopy!colimit}{colimit of types}
\indexsee{implementation}{proof assistant}
\indexsee{notation, abuse of}{abuse of notation}
\indexsee{language, abuse of}{abuse of language}
\indexsee{operator!induction}{induction principle}
\indexsee{operator!modal}{modality}
\indexsee{commutative!group}{group, abelian}
\indexsee{countable axiom of choice}{axiom of choice, countable}

% tell the index to get itself into the table of contents
\epubNewSegment[section]
\phantomsection % black magic to get TOC to point to correct page
\addcontentsline{toc}{part}{Index}
\markboth{}{\textsc{Index}}
\renewcommand{\markboth}[2]{}
{%\OPTindexfont
%\setlength{\columnsep}{\OPTindexcolumnsep}
\printindex
}

% The back cover
%\include{back}

\end{document}

%%% Local Variables: 
%%% mode: latex
%%% TeX-master: "hott-online"
%%% End: 
